<?xml version="1.0" encoding="utf-8"?>
<odoo>
    <data>
        <record id="silver_contract_view_form_provisioning" model="ir.ui.view">
            <field name="name">silver.contract.form.provisioning</field>
            <field name="model">silver.contract</field>
            <field name="inherit_id" ref="silver_contract.silver_contract_view_form"/>
            <field name="arch" type="xml">
                <xpath expr="//header" position="inside">
                    <!--button name="action_provision_base" string="Aprovisionar Servicio" type="object" class="oe_highlight" invisible="state_service != 'inactive'"/-->



                </xpath>


                <xpath expr="//field[@name='line_ids']" position="attributes">
                    <attribute name="context">{'default_linktype_id':linktype_id, 'default_line_type': 'recurring'}</attribute>
                </xpath>

                <xpath expr="//field[@name='line_ids']/tree/field[@name='name']" position="before">
                       <field name="linktype_id" options="{'no_create_edit': True, 'no_quick_create': True}"
                       column_invisible="1"
                       />
                                                            <field name="product_id"
                                                                   options="{'no_create_edit': True, 'no_quick_create': True}"
                                               domain="[('type', '=',  'service' ),('linktype_id','=',linktype_id)]"/>
                </xpath>


                <xpath expr="//field[@name='discount_line_ids']/tree/field[@name='description']" position="before">

                    <field name="product_id" options="{'no_create_edit': True, 'no_quick_create': True}"/>
                </xpath>

                <xpath expr="//field[@name='service_type_id']" position="after">

                    <field name="linktype_id"
                           options="{'no_create_edit': True, 'no_quick_create': True}"
                           readonly="state != 'draft'" domain="[('service_type_id', '=', service_type_id)]"/>
                </xpath>


                <xpath expr="//notebook" position="inside">

                    <page name="provisioning" string="Servicio Internet" invisible="state not in ['open', 'active'] or service_type_code!='internet'" >
                        <group>

                            <field name="wan_config_successful" invisible="1"/>
                        <field name="wifi_config_successful" invisible="1"/>
                        <field name="state_service" invisible="1"/>
                        <field name="state"  invisible="1"/>
                             <!--field name="linktype_id" readonly="state_service == 'active'"/-->
                          <field name="node_id" readonly="state_service == 'active'"/>
                                        <field name="box_id" readonly="state_service == 'active'" invisible="(not has_olt)" domain="[('node_id', '=', node_id)]"/>

                        </group>
   <group>
                                <group name="ips_networks_2" string="Datos de Acceso" invisible="(not has_olt)">


                                        <field name="core_id" readonly="(state_service == 'active')  " options="{'no_create': True}"
                                        domain="[('node_id', '=', node_id)]"
                                        />
                                    <field name="has_olt" invisible="1"/>
                                        <field name="olt_id" readonly="state_service == 'active'"
domain="[('node_id', '=', node_id), ('core_ids', 'in', core_id)]"
                                              options="{'no_create': True}"/>

                                        <button name="action_open_onu_selector_wizard"
                                                type="object"
                                                string="Descubrir ONUS"
                                                class="oe_highlight oe200"
                                                invisible="(not olt_id) or (state_service == 'active')"/>
                                    <field name="old_discovered" invisible="1" />
                                        <field name="discovered_onu_id" colspan="1"
                                                    readonly="state_service == 'active'"
                                               domain="[('olt_id', '=', olt_id), '|', ('contract_id', '=', False), ('contract_id', '=', id)]"
                                               invisible="(old_discovered and (discovered_onu_id==False)) or (not olt_id) or (state_service == 'active')" nolabel="1" />
<br invisible="(olt_id==False) or (state_service == 'active') or(  (old_discovered == False) or (discovered_onu_id != False))" />
                                    <!--br invisible="(not ((not olt_id) or (state_service == 'active')))"/-->

                        <field name="olt_port_id" domain="[('olt_id', '=', olt_id)]"  readonly="state_service == 'active'"/>
                        <field name="onu_pon_id"  readonly="state_service == 'active'"/>
                                    <field name="changed_onu" invisible="1"/>
   <field name="vlan_id"  readonly="state_service == 'active'"
          context="{'default_core_id':core_id}"
          domain="['|', '|', ('olt_port_id', '=', olt_port_id), '&amp;', ('olt_id','=',olt_id), ('olt_port_id','=',False),
                '&amp;', ('core_id', 'in', core_id), ('olt_port_id','=',False)]"/>
                                    <field name="old_onu_pon_id" invisible="1"/>
                                    <!--ield name="state"/>
                                    <field name="state_service"/>
                                    <field name="olt_state"/-->

  <!--div class="o_row" colspan="2" name="onu_pon_id" >
    <label for="onu_pon_id" decoration-bf="1"/>
                                <field name="onu_pon_id" readonly="state_service == 'active'"
                                     />

                                    <button name="action_check_olt_state" type="object" string="Probar" invisible="olt_state!='pending'"
                                        class="oe_highlight" />
                                    <button name="action_check_olt_state" type="object" string="Down" invisible="olt_state!='down'"
                                        class="oe_highlight status-disabled" />
                                    <button name="action_check_olt_state" type="object" string="Activo" invisible="olt_state!='active' and olt_state!='connected'"
                                        class="oe_highlight status-active" />
      <field name="olt_state" invisible="1"/>
</div-->





                                    <button name="action_provision_base"
                                                type="object"
                                                string="Aprovisionar Servicio"
                                                class="oe_highlight  oe200"
                                                invisible="(not olt_id) or(state not in ['open', 'active']) or (state_service != 'inactive') "/>

                                    <button name="action_check_olt_state"
                                                type="object"
                                                string="Comprobar conexión"
                                                class="oe_highlight  oe200"
                                                invisible="(state not in ['open', 'active']) or (state_service != 'active')"/>
                                        <field name="olt_state"  nolabel="1"
                                               widget="badge"  invisible="(state not in ['open', 'active']) or (state_service != 'active')"
                           decoration-success="olt_state in ['active', 'connected']"
                           decoration-warning="olt_state in ('suspended', 'disabled', 'waiting')"
                           decoration-danger="olt_state in ['removed', 'down']"/>


                                                        <button name="action_suspend_service" string="Suspender Servicio" type="object" class="oe_highlight  oe200" invisible="(state not in ['open', 'active']) or (state_service != 'active')"/>
                    <button name="action_terminate_service" string="Dar de Baja" type="object" class="oe_highlight  oe200" invisible="(state not in ['open', 'active']) or (state_service not in ['suspended'])"/>
                    <button name="action_reconnection_service_button" type="object" class="oe_highlight  oe200" string="Restaurar Servicio" invisible="(state not in ['open', 'active']) or ( state_service not in ['terminated', 'suspended']) "/>

                                    <field name="wan_state"  nolabel="1"
                                               widget="badge"  invisible="(state not in ['open', 'active']) or (state_service != 'active')"
                           decoration-success="wan_state in ['active', 'connected']"
                           decoration-danger="wan_state in ['disconnected']"/>
                                    <!--field name="contract_status_widget" nolabel="1" widget="contract_olt_status" invisible="state_service != 'active'"/-->

                                    </group>

         <group string="Equipo del Cliente" invisible="(not has_olt)">
                                <group class="col-lg-9">

                                        <field name="stock_lot_id" readonly="state_service == 'active'" context="{'default_etype':'onu'}" domain="[('etype','=','onu')]" options="{'no_create_edit': False, 'no_quick_create': True}"/>

                                 <label for="brand_id" />
                    <div class="o_row d-flex align-items-center">
                        <field name="brand_id"  nolabel="1"/>
                        <field name="brand_logo" widget="image" class="ms-2" style="width: 24px; height: 24px;" invisible="not brand_id"/>
                    </div>



                    <!--field name="hardware_model_id"/-->
             <field name="profile_id"  readonly="state_service == 'active'" invisible="(not has_olt)"/>
                    <!--field name="software_version"/>
                    <field name="firmware_version"/-->
                <field name="mac_address_onu"/>

                                        <field name="is_bridge" readonly="state_service == 'active'"/>


                                    </group>
                                <group>
                                    <button name="action_contract_reboot_onu" type="object" class="btn-secondary  oe200"
                                            icon="fa-refresh" string="Reiniciar ONU"
                                            invisible="(state not in ['open', 'active']) or ( state_service not in ['active', 'suspended']) "/>
                                    <button name="action_contract_reset_onu" type="object" class="btn-secondary  oe200"
                                            icon="fa-undo" string="Factory ONU"
                                            invisible="(state not in ['open', 'active']) or ( state_service not in ['terminated', 'active', 'suspended']) "/>
                                </group>


                            </group>

   </group>
<group>

                                    <group string="Datos del Radius">
<group colspan="4">

                                        <field name="core_id" readonly="(state_service == 'active') and (radius_state == 'active') and (core_state == 'active') " options="{'no_create': True}"
                                        domain="[('node_id', '=', node_id)]"  invisible="(has_olt)"/>
                                        <field name="ap_id" readonly="state_service == 'active'" invisible="has_olt" domain="[('core_id', '=', core_id)]"/>

        <!--field name="ip_address_ids"
    order="public asc,  ip_int asc" widget="many2many_tags"
                       domain="['|',  ('olt_port_id', '=', olt_port_id),
                                  '|', ('olt_id', '=', olt_id),
                                     '|',('core_id', '=', core_id),
                                         '|', ('node_ids', 'in', node_id), ('core_ids', 'in', core_id)]"
    context="{'search_default_group_by_pool_id': 1, 'alala': 2}"
    />
    <field name="ip_address_count" invisible="1"/>
                                    <field name="ip_address_id"
                                             domain="[( 'id', 'in', ip_address_ids) ]"
                                             invisible = "ip_address_count &lt;= 1"
                                    context="{'order_display': 'public asc,ip_int asc'}"
                                    /-->
  <field name="ip_address_id"
                                             domain="[
                                          '&amp;',
                                             ('used', '=', False),

                                             '|',
                                                  '&amp;',
                                                    ('public', '=', False),
                                                    '|',
                                                        '|',
                                                            ('olt_port_id', '=', olt_port_id),
                                                            '&amp;',
                                                                ('olt_port_id','=',False),
                                                                ('olt_id', '=', olt_id),
                                                        '&amp;',
                                                            '&amp;',
                                                                ('olt_port_id','=',False),
                                                                ('olt_id', '=', False),
                                                             ('core_id', '=', core_id),
                                                 '&amp;',
                                                    ('public', '=', True),
                                                    '|',
                                                        ('node_ids', 'in', node_id),
                                                        ('core_ids', 'in', core_id)
                                       ]"
    context="{'search_default_group_by_pool_id': 1, 'alala': 2, 'order_display': 'public asc, olt_port_id desc, olt_id asc, ip_int asc'}"

                                            />

                                        <field name="pppoe_user"/>
                                        <field name="pppoe_password" password="True"/>


      <!--div class="o_row" colspan="2" name="pppoe_password" >
    <label for="pppoe_password" decoration-bf="1"/>
                                <field name="pppoe_password" password="True"
                                     />

                                    <button name="action_add_radius_access" type="object" string="Probar" invisible="radius_state!='pending'"
                                        class="oe_highlight" />
                                    <button name="action_add_radius_access" type="object" string="Down" invisible="radius_state!='down'"
                                        class="oe_highlight status-disabled" />
                                    <button name="action_add_radius_access" type="object" string="Activo" invisible="radius_state!='active' and radius_state!='connected'"
                                        class="oe_highlight status-active" />
      <field name="radius_state" invisible="1"/>
</div-->

</group>
                                        <group colspan="4">
                                            <group class="col-lg-9">

                                            <button name="action_add_radius_access"
                                                type="object"
                                                string="Establecer usuario"
                                                class="oe_highlight  oe200"
                                                invisible="(pppoe_user == None) or (pppoe_password == None)"/>


   <field name="radius_state" widget="badge"
                           decoration-success="radius_state in ['active', 'connected']"
                           decoration-warning="radius_state in ('suspended', 'disabled')"
                           decoration-danger="radius_state in ['removed', 'down']"  nolabel="1" />

                                 <!--button name="action_check_radius_connection"
                                                type="object"
                                                string="Probar Conexión"
                                                class="oe_highlight"
                                                invisible="(pppoe_user == None) or (pppoe_password == None)"/-->
                                 <field name="core_state"  widget="badge"
                                         invisible="1"
                           decoration-success="core_state in ['active', 'connected']"
                           decoration-warning="core_state in ('suspended', 'disabled')"
                           decoration-danger="core_state in ['removed', 'down']"  nolabel="1" />

</group> </group>
                                        <group>
                                    <button name="get_radius_user_info"
                                            type="object"
                                            string="Detalles"
                                            icon="fa-anchor"
                                            class="btn-secondary  oe200"
                                            invisible="(pppoe_user == None)"/>

                                             <button name="action_view_pppoe_traffic_chart"
                                                     type="object"
                                                    class=" oe200 btn-secondary"
                                                     icon="fa-area-chart"
                                                     string="PPP"
                                                     invisible="(state_service != 'active') "/>


<button name="action_terminate_service" string="Dar de Baja" type="object" class="oe_highlight  oe200" invisible="(has_olt) or (state not in ['open', 'active']) or (state_service not in ['suspended', 'active'])"/>

                                        </group>

                                    </group>
     <group invisible="manual != True">
<field name="manual" />
         </group>

                                     <group string="Configuración WAN" invisible="(not has_olt) or (manual == True)">

                                <field name="sssid" invisible="1"/>
                                <field name="password" invisible="1" password="True"/>
                             <field name="custom_channel_id" invisible="1"/>
                                <!--field name="contract_mode_wan_ids"/-->

                                <field name="wifi_line_ids" nolabel="1"  colspan="2">
                                    <tree>
                                        <field name="ssid_index"/>
                                        <field name="name"/>
                                        <field name="password" />
                                        <!--field name="is_hidden" invisible="1"/>
                                        <field name="auth_mode" invisible="1"/>
                                        <field name="encrypt_type" invisible="1"/-->
                                    </tree>
                                </field>
<field name="state_service" invisible="1"/>
                                         <field name="olt_state" invisible="1" />
                                         <field name="service_type_code" invisible="1"/>
                                         <group>
  <button name="action_provision_wan" string="Configurar WAN" type="object" class="oe_highlight oe200" invisible="(state_service == 'inactive') or (olt_state != 'active')"/>
<button name="button_get_wan_info" type="object" string="Info" class=" oe200  btn-secondary" invisible="wan_config_successful==True" icon="fa-info-circle"
                                />
<button name="button_get_wan_info" type="object" string="Info" invisible="wan_config_successful!=True" class="btn-success oe200" icon="fa-info-circle"
                                />

                    <button name="action_provision_wifi" string="Aplicar WiFi" type="object" class="oe_highlight oe200" invisible=" (state_service == 'inactive') or (olt_state != 'active')"/>
<button name="button_get_wifi_info" type="object" string="Wifi" invisible="wifi_config_successful==True" icon="fa-wifi" class=" oe200 btn-secondary"
/>
<button name="button_get_wifi_info" type="object" string="Wifi" invisible="wifi_config_successful!=True"  class="btn-success oe200" icon="fa-wifi"
/>

                                             </group>
                                         <group>
</group>
                            </group>


                            <group string="Equipo del Cliente" invisible="has_olt">
                                <group class="col-lg-9">

                                        <field name="stock_lot_id" readonly="state_service == 'active'" context="{'default_etype':'onu'}" domain="[('etype','=','onu')]" options="{'no_create_edit': False, 'no_quick_create': True}"/>

                             <label for="brand_id" />
                    <div class="o_row d-flex align-items-center">
                        <field name="brand_id"  nolabel="1"/>
                        <field name="brand_logo" widget="image" class="ms-2" style="width: 24px; height: 24px;" invisible="not brand_id"/>
                    </div>



                    <!--field name="hardware_model_id"/-->
         <field name="profile_id"  readonly="state_service == 'active'"/>
                    <!--field name="software_version"/>
                    <field name="firmware_version"/-->
                <field name="mac_address_onu"/>

                                        <field name="is_bridge" readonly="state_service == 'active'"/>
                                </group>

                                    </group>


                                </group>

                                <group  name="other_info_internet" >
                                    <group name="ips_networks_start" string="Fechas Inicio">
                                        <field name="date_start"/>
                                        <field name="date_active"/>
                                        <field name="date_reconnection"/>
                                    </group>
                                    <group name="ips_networks_cut" string="Fechas Corte">
                                        <field name="date_cut"/>
                                        <field name="date_renovation"/>
                                        <field name="date_end"/>
                                    </group>



                        </group>

                    </page>
                </xpath>
            </field>
        </record>
    </data>


</odoo>
